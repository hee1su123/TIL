## Uploading Files in S3

### 문제 발생
- DB 에 저장된 사진을 클라이언트에게 다시 보내주기 위해 작업 중 발생
- Http Response 에 Json 형태의 정보와 byte[] 형태로 변환된 사진을 같이 보내려 하다 보니 byte[] 를 읽기 위한 content-type, contenty-length 를 보내지 못함

### 발생 원인
- Http Response 에 두개의 content-type 를 보내지 못하여 생긴 오류

### 오류 해결
- 애초에 게시글 작성 방법 부터 변경
- form-data MultipartFile 로 받던 이미지 정보를 게시글 저장 전에 미리 S3 에 저장하고, 이미지 Url 을 전달 받아 게시글을 저장
- 수정 시에도 클라이언트 측으로 파일 자체인 byte[] 가 아닌 Url 을 전달해주며 수정완료 시에도 Url 을 받아서 저장

### 배운점
- 한번에 많은 정보를 보내서 모든 처리를 한 요청으로 끝내는 것보다 여러 요청으로 나누어 진행하는 것이 더 효율적인 방법이다
- 만약 미리 S3 파일을 저장한 후에 게시글을 작성하지 않게 된다면, 해당 파일은 게시글이라는 정보와 맵피잉 되지 않아 나중에 스케쥴러, Batch 같은 툴을 활용해 삭제시켜준다고 한다.